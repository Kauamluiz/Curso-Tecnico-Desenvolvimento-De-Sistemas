SIMULADO DA RECUPERAÇÃO

QUESTAO - 1
SELECT
  USUARIO.IDUSUARIO
  , USUARIO.NOME
  , ACESSO.IDACESSO
  , ACESSO.DATA
  , ACESSO.HORA
  , EPISODIO.IDEPISODIO
  , EPISODIO.NOME
  , EPISODIO.NUMERO
  , EPISODIO.TEMPORADA
FROM
  USUARIO
  INNER JOIN ACESSO ON
  USUARIO.IDUSUARIO = ACESSO.IDUSUARIO
  INNER JOIN EPISODIO ON
  ACESSO.IDEPISODIO = EPISODIO.IDEPISODIO
WHERE
  ACESSO.DATA BETWEEN '2016-07-01' AND '2016-07-31'
ORDER BY
  USUARIO.NOME 
  , EPISODIO.IDEPISODIO;



QUESTAO - 2
SELECT
  USUARIO.IDUSUARIO
  , USUARIO.NOME
  , USUARIO.EMAIL
  , MAX(ACESSO.IDEPISODIO)
FROM
  USUARIO
  INNER JOIN ACESSO ON
  USUARIO.IDUSUARIO = ACESSO.IDUSUARIO
GROUP BY
  USUARIO.IDUSUARIO
  , USUARIO.NOME
  , USUARIO.EMAIL;



QUESTAO - 3
SELECT
  EPISODIO.TEMPORADA
  , SUM(EPISODIO.DURACAO)
FROM
  EPISODIO
GROUP BY
  EPISODIO.TEMPORADA;



QUESTAO - 4
SELECT
  EPISODIO.TEMPORADA
  , COUNT(EPISODIO.IDEPISODIO)
  , COUNT(ACESSO.IDACESSO)
  , COUNT(ACESSO.IDUSUARIO)
FROM
  EPISODIO
  INNER JOIN ACESSO ON
  EPISODIO.IDEPISODIO = ACESSO.IDEPISODIO
GROUP BY
  EPISODIO.TEMPORADA;



QUESTAO - 5
SELECT
  CANDIDATO.PARTIDO
  , ELEICAO.DESCRICAO
  , COUNT(VOTO.IDELEITOR)
FROM
  CANDIDATO
  INNER JOIN VOTO ON
  CANDIDATO.IDCANDIDATO = VOTO.IDCANDIDATO
  INNER JOIN ELEICAO ON
  ELEICAO.IDELEICAO = VOTO.IDELEICAO
GROUP BY
  CANDIDATO.PARTIDO
  , ELEICAO.DESCRICAO;



QUESTAO - 6
SELECT
  CANDIDATO.NOME
  , CANDIDATO.PARTIDO
  , COUNT(VOTO.IDELEITOR)
FROM
  CANDIDATO
  INNER JOIN CANDIDATURA ON
  CANDIDATO.IDCANDIDATO = CANDIDATURA.IDCANDIDATO
  INNER JOIN ELEICAO ON
  ELEICAO.IDELEICAO = CANDIDATURA.IDELEICAO
  INNER JOIN VOTO ON
  CANDIDATO.IDCANDIDATO = VOTO.IDCANDIDATO
WHERE
  ELEICAO.DESCRICAO LIKE '%2%' AND VOTO.IDELEICAO = 1
GROUP BY
  CANDIDATO.NOME
  , CANDIDATO.PARTIDO;



QUESTAO - 7
SELECT
  ELEICAO.IDELEICAO
  , ELEICAO.DESCRICAO
  , ELEITOR.IDELEITOR
  , ELEITOR.NOME
  , CANDIDATO.IDCANDIDATO
  , CANDIDATO.NOME
  , CANDIDATO.PARTIDO
FROM
  ELEICAO
  INNER JOIN VOTO ON
  ELEICAO.IDELEICAO = VOTO.IDELEICAO
  INNER JOIN CANDIDATO ON
  CANDIDATO.IDCANDIDATO = VOTO.IDCANDIDATO
  INNER JOIN ELEITOR ON
  ELEITOR.IDELEITOR = VOTO.IDELEITOR;



QUESTAO - 8
SELECT
  ELEITOR.IDELEITOR
  , ELEITOR.NOME
FROM
  ELEITOR
  LEFT JOIN VOTO ON
  ELEITOR.IDELEITOR = VOTO.IDELEITOR
WHERE
  VOTO.IDELEITOR IS NULL;